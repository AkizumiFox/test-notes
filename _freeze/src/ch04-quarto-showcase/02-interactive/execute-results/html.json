{
  "hash": "1a71cc9ba31a49ef035a700d25e485ee",
  "result": {
    "engine": "jupyter",
    "markdown": "---\nchapter-number: 7\nfilters:\n  - latex-environment\n  - chapter-number\nformat:\n  pdf:\n    documentclass: memoir\n    classoption: [13pt, a4paper]\n    number-sections: true\n    pdf-engine: lualatex\n    geometry: [top=30mm, left=25mm, right=25mm, bottom=30mm]\n    include-in-header:\n      text: |\n        \\usepackage[quartoenv]{../../config/latex-template}\n        \\directlua{require(\"../../config/strip-numbers\")}\nexecute:\n  echo: true\n  warning: false\njupyter: python3\n---\n\n::: {.content-visible when-format=\"html\"}\n::: {.hidden}\n$$\n% ======================================================================================\n% MATHJAX MACROS (HTML)\n% ======================================================================================\n\n% --- Sets (Blackboard Bold) ---\n\\def\\nR{\\mathbb{R}}\n\\def\\nC{\\mathbb{C}}\n\\def\\nN{\\mathbb{N}}\n\\def\\nZ{\\mathbb{Z}}\n\\def\\nQ{\\mathbb{Q}}\n\\def\\nF{\\mathbb{F}}\n\\def\\nP{\\mathbb{P}}\n\\def\\nE{\\mathbb{E}}\n\n% --- Calligraphic Sets ---\n\\def\\sA{\\mathcal{A}}\n\\def\\sB{\\mathcal{B}}\n\\def\\sC{\\mathcal{C}}\n\\def\\sD{\\mathcal{D}}\n\\def\\sE{\\mathcal{E}}\n\\def\\sF{\\mathcal{F}}\n\\def\\sG{\\mathcal{G}}\n\\def\\sH{\\mathcal{H}}\n\\def\\sL{\\mathcal{L}}\n\\def\\sM{\\mathcal{M}}\n\\def\\sN{\\mathcal{N}}\n\\def\\sO{\\mathcal{O}}\n\\def\\sP{\\mathcal{P}}\n\\def\\sS{\\mathcal{S}}\n\\def\\sT{\\mathcal{T}}\n\\def\\sX{\\mathcal{X}}\n\\def\\sY{\\mathcal{Y}}\n\n% --- Latin Vectors (\\va ... \\vz) ---\n\\def\\va{\\mathbf{a}}\n\\def\\vb{\\mathbf{b}}\n\\def\\vc{\\mathbf{c}}\n\\def\\vd{\\mathbf{d}}\n\\def\\ve{\\mathbf{e}}\n\\def\\vf{\\mathbf{f}}\n\\def\\vg{\\mathbf{g}}\n\\def\\vh{\\mathbf{h}}\n\\def\\vi{\\mathbf{i}}\n\\def\\vj{\\mathbf{j}}\n\\def\\vk{\\mathbf{k}}\n\\def\\vl{\\mathbf{l}}\n\\def\\vm{\\mathbf{m}}\n\\def\\vn{\\mathbf{n}}\n\\def\\vo{\\mathbf{o}}\n\\def\\vp{\\mathbf{p}}\n\\def\\vq{\\mathbf{q}}\n\\def\\vr{\\mathbf{r}}\n\\def\\vs{\\mathbf{s}}\n\\def\\vt{\\mathbf{t}}\n\\def\\vu{\\mathbf{u}}\n\\def\\vv{\\mathbf{v}}\n\\def\\vw{\\mathbf{w}}\n\\def\\vx{\\mathbf{x}}\n\\def\\vy{\\mathbf{y}}\n\\def\\vz{\\mathbf{z}}\n\n% --- Latin Matrices (\\A ... \\Z) ---\n\\def\\A{\\mathbf{A}}\n\\def\\B{\\mathbf{B}}\n\\def\\C{\\mathbf{C}}\n\\def\\D{\\mathbf{D}}\n\\def\\E{\\mathbf{E}}\n\\def\\F{\\mathbf{F}}\n\\def\\G{\\mathbf{G}}\n\\def\\H{\\mathbf{H}}\n\\def\\I{\\mathbf{I}}\n\\def\\J{\\mathbf{J}}\n\\def\\K{\\mathbf{K}}\n\\def\\L{\\mathbf{L}}\n\\def\\M{\\mathbf{M}}\n\\def\\N{\\mathbf{N}}\n\\def\\O{\\mathbf{O}}\n\\def\\P{\\mathbf{P}}\n\\def\\Q{\\mathbf{Q}}\n\\def\\R{\\mathbf{R}}\n\\def\\S{\\mathbf{S}}\n\\def\\T{\\mathbf{T}}\n\\def\\U{\\mathbf{U}}\n\\def\\V{\\mathbf{V}}\n\\def\\W{\\mathbf{W}}\n\\def\\X{\\mathbf{X}}\n\\def\\Y{\\mathbf{Y}}\n\\def\\Z{\\mathbf{Z}}\n\n% --- Greek Vectors ---\n\\def\\valpha{\\boldsymbol{\\alpha}}\n\\def\\vbeta{\\boldsymbol{\\beta}}\n\\def\\vgamma{\\boldsymbol{\\gamma}}\n\\def\\vdelta{\\boldsymbol{\\delta}}\n\\def\\vepsilon{\\boldsymbol{\\epsilon}}\n\\def\\vzeta{\\boldsymbol{\\zeta}}\n\\def\\veta{\\boldsymbol{\\eta}}\n\\def\\vtheta{\\boldsymbol{\\theta}}\n\\def\\viota{\\boldsymbol{\\iota}}\n\\def\\vkappa{\\boldsymbol{\\kappa}}\n\\def\\vlambda{\\boldsymbol{\\lambda}}\n\\def\\vmu{\\boldsymbol{\\mu}}\n\\def\\vnu{\\boldsymbol{\\nu}}\n\\def\\vxi{\\boldsymbol{\\xi}}\n\\def\\vpi{\\boldsymbol{\\pi}}\n\\def\\vrho{\\boldsymbol{\\rho}}\n\\def\\vsigma{\\boldsymbol{\\sigma}}\n\\def\\vtau{\\boldsymbol{\\tau}}\n\\def\\vupsilon{\\boldsymbol{\\upsilon}}\n\\def\\vphi{\\boldsymbol{\\phi}}\n\\def\\vchi{\\boldsymbol{\\chi}}\n\\def\\vpsi{\\boldsymbol{\\psi}}\n\\def\\vomega{\\boldsymbol{\\omega}}\n\n% --- Greek Matrices ---\n\\def\\vGamma{\\boldsymbol{\\Gamma}}\n\\def\\vDelta{\\boldsymbol{\\Delta}}\n\\def\\vTheta{\\boldsymbol{\\Theta}}\n\\def\\vLambda{\\boldsymbol{\\Lambda}}\n\\def\\vXi{\\boldsymbol{\\Xi}}\n\\def\\vPi{\\boldsymbol{\\Pi}}\n\\def\\vSigma{\\boldsymbol{\\Sigma}}\n\\def\\vUpsilon{\\boldsymbol{\\Upsilon}}\n\\def\\vPhi{\\boldsymbol{\\Phi}}\n\\def\\vPsi{\\boldsymbol{\\Psi}}\n\\def\\vOmega{\\boldsymbol{\\Omega}}\n\n% --- Random Variables ---\n\\def\\ra{\\mathbf{a}}\n\\def\\rb{\\mathbf{b}}\n\\def\\rc{\\mathbf{c}}\n\\def\\rd{\\mathbf{d}}\n\\def\\re{\\mathbf{e}}\n\\def\\rf{\\mathbf{f}}\n\\def\\rg{\\mathbf{g}}\n\\def\\rh{\\mathbf{h}}\n\\def\\ri{\\mathbf{i}}\n\\def\\rj{\\mathbf{j}}\n\\def\\rk{\\mathbf{k}}\n\\def\\rl{\\mathbf{l}}\n\\def\\rm{\\mathbf{m}}\n\\def\\rn{\\mathbf{n}}\n\\def\\ro{\\mathbf{o}}\n\\def\\rp{\\mathbf{p}}\n\\def\\rq{\\mathbf{q}}\n\\def\\rr{\\mathbf{r}}\n\\def\\rs{\\mathbf{s}}\n\\def\\rt{\\mathbf{t}}\n\\def\\ru{\\mathbf{u}}\n\\def\\rv{\\mathbf{v}}\n\\def\\rw{\\mathbf{w}}\n\\def\\rx{\\mathbf{x}}\n\\def\\ry{\\mathbf{y}}\n\\def\\rz{\\mathbf{z}}\n\n% --- Special ---\n\\def\\vzero{\\mathbf{0}}\n\\def\\vone{\\mathbf{1}}\n\n% --- Probability & Statistics ---\n\\def\\Ev{\\mathbb{E}}\n\\def\\Pr{\\operatorname{Pr}}\n\\def\\Var{\\operatorname{Var}}\n\\def\\Cov{\\operatorname{Cov}}\n\\def\\Cor{\\operatorname{Cor}}\n\\def\\Corr{\\operatorname{Corr}}\n\n% --- Distributions ---\n\\def\\distBern{\\operatorname{Ber}}\n\\def\\distBin{\\operatorname{Bin}}\n\\def\\distGeom{\\operatorname{Geo}}\n\\def\\distNB{\\operatorname{NB}}\n\\def\\distPois{\\operatorname{Poi}}\n\\def\\distHyp{\\operatorname{Hyp}}\n\\def\\distUnif{\\operatorname{Unif}}\n\\def\\distExp{\\operatorname{Exp}}\n\\def\\distGamma{\\operatorname{Gamma}}\n\\def\\distN{\\mathcal{N}}\n\\def\\distBeta{\\operatorname{Beta}}\n\\def\\distCauchy{\\operatorname{Cauchy}}\n\\def\\distDir{\\operatorname{Dir}}\n\\def\\distMult{\\operatorname{Mult}}\n\\def\\distWishart{\\operatorname{Wishart}}\n\n% --- Linear Algebra ---\n\\def\\tr{\\operatorname{tr}}\n\\def\\trace{\\operatorname{tr}}\n\\def\\rank{\\operatorname{rank}}\n\\def\\nullity{\\operatorname{nullity}}\n\\def\\Span{\\operatorname{span}}\n\\def\\spn{\\operatorname{span}}\n\\def\\col{\\operatorname{col}}\n\\def\\row{\\operatorname{row}}\n\\def\\nul{\\operatorname{nul}}\n\\def\\img{\\operatorname{img}}\n\\def\\diag{\\operatorname{diag}}\n\\def\\dd{\\mathrm{d}}\n\\def\\T{^\\top}\n\\def\\transpose{^\\top}\n\\def\\inv{^{-1}}\n\n% --- Delimiters ---\n\\def\\abs#1{\\left\\lvert#1\\right\\rvert}\n\\def\\norm#1{\\left\\lVert#1\\right\\rVert}\n\\def\\floor#1{\\left\\lfloor#1\\right\\rfloor}\n\\def\\ceil#1{\\left\\lceil#1\\right\\rceil}\n\\def\\inner#1#2{\\langle #1, #2 \\rangle}\n\n% --- Other Operators ---\n\\def\\lcm{\\operatorname{lcm}}\n\\def\\im{\\operatorname{im}}\n\\def\\sgn{\\operatorname{sgn}}\n\\def\\argmax{\\operatorname{argmax}}\n\\def\\argmin{\\operatorname{argmin}}\n\\def\\softmax{\\operatorname{softmax}}\n\n% --- Shortcuts ---\n\\def\\x{\\vx}\n\\def\\y{\\vy}\n\\def\\z{\\vz}\n\\def\\w{\\vw}\n\\def\\u{\\vu}\n\\def\\e{\\ve}\n\n% --- Backward Compatibility (old style) ---\n% Lowercase bold\n\\def\\ba{\\mathbf{a}}\n\\def\\bb{\\mathbf{b}}\n\\def\\bc{\\mathbf{c}}\n\\def\\bd{\\mathbf{d}}\n\\def\\be{\\mathbf{e}}\n\\def\\bff{\\mathbf{f}}\n\\def\\bg{\\mathbf{g}}\n\\def\\bh{\\mathbf{h}}\n\\def\\bi{\\mathbf{i}}\n\\def\\bj{\\mathbf{j}}\n\\def\\bk{\\mathbf{k}}\n\\def\\bl{\\mathbf{l}}\n\\def\\bm{\\mathbf{m}}\n\\def\\bn{\\mathbf{n}}\n\\def\\bo{\\mathbf{o}}\n\\def\\bp{\\mathbf{p}}\n\\def\\bq{\\mathbf{q}}\n\\def\\br{\\mathbf{r}}\n\\def\\bs{\\mathbf{s}}\n\\def\\bt{\\mathbf{t}}\n\\def\\bu{\\mathbf{u}}\n\\def\\bv{\\mathbf{v}}\n\\def\\bw{\\mathbf{w}}\n\\def\\bx{\\mathbf{x}}\n\\def\\by{\\mathbf{y}}\n\\def\\bz{\\mathbf{z}}\n% Uppercase bold\n\\def\\bA{\\mathbf{A}}\n\\def\\bB{\\mathbf{B}}\n\\def\\bC{\\mathbf{C}}\n\\def\\bD{\\mathbf{D}}\n\\def\\bE{\\mathbf{E}}\n\\def\\bF{\\mathbf{F}}\n\\def\\bG{\\mathbf{G}}\n\\def\\bH{\\mathbf{H}}\n\\def\\bI{\\mathbf{I}}\n\\def\\bJ{\\mathbf{J}}\n\\def\\bK{\\mathbf{K}}\n\\def\\bL{\\mathbf{L}}\n\\def\\bM{\\mathbf{M}}\n\\def\\bN{\\mathbf{N}}\n\\def\\bO{\\mathbf{O}}\n\\def\\bP{\\mathbf{P}}\n\\def\\bQ{\\mathbf{Q}}\n\\def\\bR{\\mathbf{R}}\n\\def\\bS{\\mathbf{S}}\n\\def\\bT{\\mathbf{T}}\n\\def\\bU{\\mathbf{U}}\n\\def\\bV{\\mathbf{V}}\n\\def\\bW{\\mathbf{W}}\n\\def\\bX{\\mathbf{X}}\n\\def\\bY{\\mathbf{Y}}\n\\def\\bZ{\\mathbf{Z}}\n% Greek bold (use \\symbf for compatibility)\n\\def\\bSigma{\\mathbf{\\Sigma}}\n\\def\\bLambda{\\mathbf{\\Lambda}}\n\\def\\bOmega{\\mathbf{\\Omega}}\n$$\n:::\n:::\n\n\n# Interactive Visualizations\n\nThis chapter demonstrates Python code execution and interactive visualizations in Quarto.\n\n## Matplotlib Visualizations\n\n### Eigenvalue Visualization\n\n::: {#cell-fig-eigenvalues .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Generate random matrix and compute eigenvalues\nnp.random.seed(42)\nn = 100\nA = np.random.randn(n, n)\neigenvalues = np.linalg.eigvals(A)\n\n# Plot\nfig, ax = plt.subplots(figsize=(8, 6))\nax.scatter(eigenvalues.real, eigenvalues.imag, alpha=0.6, c='steelblue', s=30)\nax.axhline(y=0, color='k', linewidth=0.5)\nax.axvline(x=0, color='k', linewidth=0.5)\nax.set_xlabel('Real part')\nax.set_ylabel('Imaginary part')\nax.set_title(f'Eigenvalues of a {n}×{n} Random Matrix')\nax.grid(True, alpha=0.3)\nax.set_aspect('equal')\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Eigenvalues of a random matrix in the complex plane](02-interactive_files/figure-html/fig-eigenvalues-output-1.png){#fig-eigenvalues width=576 height=564}\n:::\n:::\n\n\n### Singular Value Decay\n\n::: {#cell-fig-svd-decay .cell execution_count=2}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(42)\nn = 50\n\nfig, axes = plt.subplots(1, 3, figsize=(12, 4))\n\nfor idx, rank in enumerate([5, 15, 50]):\n    # Create low-rank matrix\n    U = np.random.randn(n, rank)\n    V = np.random.randn(rank, n)\n    A = U @ V + 0.1 * np.random.randn(n, n)  # Add noise\n    \n    # Compute SVD\n    _, s, _ = np.linalg.svd(A)\n    \n    axes[idx].semilogy(range(1, n+1), s, 'o-', markersize=4)\n    axes[idx].axvline(x=rank, color='r', linestyle='--', label=f'True rank = {rank}')\n    axes[idx].set_xlabel('Index')\n    axes[idx].set_ylabel('Singular value')\n    axes[idx].set_title(f'Approximate Rank {rank}')\n    axes[idx].legend()\n    axes[idx].grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Singular value decay for matrices of different ranks](02-interactive_files/figure-html/fig-svd-decay-output-1.png){#fig-svd-decay width=1140 height=372}\n:::\n:::\n\n\n### Power Iteration Convergence\n\n::: {#cell-fig-power-iteration .cell execution_count=3}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndef power_iteration_history(A, max_iter=50):\n    \"\"\"Power iteration with convergence history.\"\"\"\n    n = A.shape[0]\n    v = np.random.rand(n)\n    v = v / np.linalg.norm(v)\n    \n    eigenvalue_estimates = []\n    \n    for _ in range(max_iter):\n        Av = A @ v\n        v_new = Av / np.linalg.norm(Av)\n        eigenvalue = v_new @ A @ v_new\n        eigenvalue_estimates.append(eigenvalue)\n        v = v_new\n    \n    return eigenvalue_estimates\n\n# Test matrix\nnp.random.seed(42)\nA = np.array([[4, 1, 0], [1, 3, 1], [0, 1, 2]])\ntrue_eigenvalues = np.linalg.eigvals(A)\ndominant = np.max(np.abs(true_eigenvalues))\n\n# Run power iteration\nestimates = power_iteration_history(A, max_iter=30)\n\n# Plot\nfig, ax = plt.subplots(figsize=(8, 5))\nax.plot(estimates, 'b-o', label='Power iteration estimate', markersize=5)\nax.axhline(y=dominant, color='r', linestyle='--', label=f'True dominant eigenvalue = {dominant:.4f}')\nax.set_xlabel('Iteration')\nax.set_ylabel('Eigenvalue estimate')\nax.set_title('Power Iteration Convergence')\nax.legend()\nax.grid(True, alpha=0.3)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Convergence of power iteration to dominant eigenvalue](02-interactive_files/figure-html/fig-power-iteration-output-1.png){#fig-power-iteration width=757 height=468}\n:::\n:::\n\n\n## Gradient Descent Visualization\n\n::: {#cell-fig-gradient-descent .cell execution_count=4}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndef gradient_descent_2d(A, b, x0, alpha, n_iter):\n    \"\"\"Gradient descent for minimizing 0.5*x'Ax - b'x.\"\"\"\n    path = [x0.copy()]\n    x = x0.copy()\n    \n    for _ in range(n_iter):\n        grad = A @ x - b\n        x = x - alpha * grad\n        path.append(x.copy())\n    \n    return np.array(path)\n\n# Define quadratic function\nA = np.array([[3, 1], [1, 2]])\nb = np.array([1, 1])\nx_opt = np.linalg.solve(A, b)\n\n# Run gradient descent with different step sizes\nx0 = np.array([-2, 2])\nalphas = [0.1, 0.3, 0.5]\n\n# Create contour plot\nfig, ax = plt.subplots(figsize=(10, 8))\n\nx1 = np.linspace(-3, 2, 100)\nx2 = np.linspace(-1, 3, 100)\nX1, X2 = np.meshgrid(x1, x2)\nZ = np.zeros_like(X1)\nfor i in range(X1.shape[0]):\n    for j in range(X1.shape[1]):\n        x = np.array([X1[i,j], X2[i,j]])\n        Z[i,j] = 0.5 * x @ A @ x - b @ x\n\ncontour = ax.contour(X1, X2, Z, levels=20, cmap='viridis', alpha=0.5)\nax.clabel(contour, inline=True, fontsize=8)\n\ncolors = ['red', 'blue', 'green']\nfor alpha, color in zip(alphas, colors):\n    path = gradient_descent_2d(A, b, x0, alpha, 20)\n    ax.plot(path[:, 0], path[:, 1], f'{color[0]}o-', markersize=4, \n            label=f'α = {alpha}', alpha=0.7)\n\nax.plot(x_opt[0], x_opt[1], 'k*', markersize=15, label='Optimum')\nax.plot(x0[0], x0[1], 'ko', markersize=10, label='Start')\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_title('Gradient Descent Trajectories')\nax.legend()\nax.grid(True, alpha=0.3)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Gradient descent on a quadratic function](02-interactive_files/figure-html/fig-gradient-descent-output-1.png){#fig-gradient-descent width=949 height=756}\n:::\n:::\n\n\n## Matrix Heatmaps\n\n::: {#cell-fig-matrix-heatmap .cell execution_count=5}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nfig, axes = plt.subplots(2, 3, figsize=(12, 8))\n\nnp.random.seed(42)\nn = 20\n\n# Different matrix types\nmatrices = {\n    'Random': np.random.randn(n, n),\n    'Symmetric': None,  # Will be created\n    'Diagonal': np.diag(np.random.randn(n)),\n    'Tridiagonal': None,\n    'Low Rank (r=3)': None,\n    'Sparse (10%)': None\n}\n\n# Create symmetric\nA = np.random.randn(n, n)\nmatrices['Symmetric'] = (A + A.T) / 2\n\n# Create tridiagonal\nmatrices['Tridiagonal'] = np.diag(np.ones(n-1), -1) + 2*np.eye(n) + np.diag(np.ones(n-1), 1)\n\n# Create low rank\nU = np.random.randn(n, 3)\nmatrices['Low Rank (r=3)'] = U @ U.T\n\n# Create sparse\nsparse = np.zeros((n, n))\nmask = np.random.rand(n, n) < 0.1\nsparse[mask] = np.random.randn(np.sum(mask))\nmatrices['Sparse (10%)'] = sparse\n\nfor ax, (name, M) in zip(axes.flat, matrices.items()):\n    im = ax.imshow(M, cmap='RdBu', aspect='equal', vmin=-3, vmax=3)\n    ax.set_title(name)\n    ax.set_xticks([])\n    ax.set_yticks([])\n    plt.colorbar(im, ax=ax, fraction=0.046, pad=0.04)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Visualization of matrix structure](02-interactive_files/figure-html/fig-matrix-heatmap-output-1.png){#fig-matrix-heatmap width=1142 height=729}\n:::\n:::\n\n\n## Spectral Clustering Example\n\n::: {#cell-fig-spectral-clustering .cell execution_count=6}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.linalg import eigh\n\nnp.random.seed(42)\n\n# Generate two moons-like data\nn_points = 200\nt = np.linspace(0, np.pi, n_points // 2)\nx1 = np.column_stack([np.cos(t), np.sin(t)])\nx2 = np.column_stack([1 - np.cos(t), 0.5 - np.sin(t)])\nX = np.vstack([x1, x2]) + 0.1 * np.random.randn(n_points, 2)\n\n# Build similarity graph (Gaussian kernel)\ndef gaussian_kernel(X, sigma=0.5):\n    n = X.shape[0]\n    K = np.zeros((n, n))\n    for i in range(n):\n        for j in range(n):\n            K[i, j] = np.exp(-np.linalg.norm(X[i] - X[j])**2 / (2 * sigma**2))\n    return K\n\nW = gaussian_kernel(X, sigma=0.3)\nD = np.diag(W.sum(axis=1))\nL = D - W  # Unnormalized Laplacian\n\n# Compute eigenvectors\neigenvalues, eigenvectors = eigh(L, D)\n\n# Use second smallest eigenvector for clustering\nfiedler = eigenvectors[:, 1]\nlabels = (fiedler > 0).astype(int)\n\n# Plot results\nfig, axes = plt.subplots(1, 3, figsize=(14, 4))\n\n# Original data\naxes[0].scatter(X[:, 0], X[:, 1], c='steelblue', s=20)\naxes[0].set_title('Original Data')\naxes[0].set_xlabel('$x_1$')\naxes[0].set_ylabel('$x_2$')\n\n# Eigenvalue spectrum\naxes[1].plot(eigenvalues[:20], 'o-')\naxes[1].set_xlabel('Index')\naxes[1].set_ylabel('Eigenvalue')\naxes[1].set_title('Laplacian Eigenvalues')\naxes[1].axhline(y=0, color='k', linewidth=0.5)\naxes[1].grid(True, alpha=0.3)\n\n# Clustered data\naxes[2].scatter(X[labels==0, 0], X[labels==0, 1], c='red', s=20, label='Cluster 1')\naxes[2].scatter(X[labels==1, 0], X[labels==1, 1], c='blue', s=20, label='Cluster 2')\naxes[2].set_title('Spectral Clustering Result')\naxes[2].set_xlabel('$x_1$')\naxes[2].set_ylabel('$x_2$')\naxes[2].legend()\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Spectral clustering on synthetic data](02-interactive_files/figure-html/fig-spectral-clustering-output-1.png){#fig-spectral-clustering width=1333 height=372}\n:::\n:::\n\n\n## Inline Computations\n\nWe can also compute values inline. For example, the largest eigenvalue of $\\begin{pmatrix} 4 & 1 \\\\ 1 & 3 \\end{pmatrix}$ is:\n\n::: {#6ca0ef4f .cell execution_count=7}\n\n::: {.cell-output .cell-output-stdout}\n```\n4.6180\n```\n:::\n:::\n\n\nAnd its condition number is:\n\n::: {#6a17df8c .cell execution_count=8}\n\n::: {.cell-output .cell-output-stdout}\n```\n1.9387\n```\n:::\n:::\n\n\n## Data Tables\n\n::: {#tbl-eigenvalue-comparison .cell tbl-cap='Eigenvalue computation methods comparison' execution_count=9}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\n\nnp.random.seed(42)\nsizes = [10, 50, 100, 500]\nmethods = ['NumPy eig', 'NumPy eigvals', 'SciPy eigh']\n\n# Simulate timing data (not actual benchmarks)\ndata = {\n    'Matrix Size': [f'{n}×{n}' for n in sizes],\n    'NumPy eig (ms)': [0.1, 0.8, 3.2, 45.0],\n    'NumPy eigvals (ms)': [0.08, 0.6, 2.5, 38.0],\n    'SciPy eigh (ms)': [0.05, 0.3, 1.2, 15.0],\n}\n\ndf = pd.DataFrame(data)\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Matrix Size</th>\n      <th>NumPy eig (ms)</th>\n      <th>NumPy eigvals (ms)</th>\n      <th>SciPy eigh (ms)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>10×10</td>\n      <td>0.1</td>\n      <td>0.08</td>\n      <td>0.05</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>50×50</td>\n      <td>0.8</td>\n      <td>0.60</td>\n      <td>0.30</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>100×100</td>\n      <td>3.2</td>\n      <td>2.50</td>\n      <td>1.20</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>500×500</td>\n      <td>45.0</td>\n      <td>38.00</td>\n      <td>15.00</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Summary\n\nThis chapter demonstrated:\n\n1. **Matplotlib plots**: Scatter plots, line plots, contours, heatmaps\n2. **Algorithm visualization**: Power iteration, gradient descent\n3. **Interactive analysis**: Eigenvalue computation, spectral clustering\n4. **Inline Python**: Computing values within text\n5. **Data tables**: Using pandas DataFrames\n\n::: {.callout-tip}\n## Running the Code\nTo execute the Python code in this document, ensure you have Jupyter installed:\n```bash\npip install jupyter matplotlib numpy scipy pandas\n```\n:::\n\n",
    "supporting": [
      "02-interactive_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}